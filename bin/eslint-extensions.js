const fs = require('fs');

const extensions = [
  'eslint:recommended',
  "plugin:jest/recommended",
  "plugin:@typescript-eslint/eslint-recommended",
  "plugin:@typescript-eslint/recommended",
  "plugin:@typescript-eslint/recommended-requiring-type-checking"
];

const schema = { };

extensions.forEach(extensionName => {

  let config;
  if (extensionName === 'eslint:all')
    config = require('eslint/conf/eslint-all');
  else if (extensionName === 'eslint:recommended')
    config = require('eslint/conf/eslint-recommended');
  else {
    const parts = extensionName.substring(7).split('/');
    let moduleName;
    if (parts[0].startsWith('@')) {
      moduleName = `${parts[0]}/eslint-plugin`;
      if (parts.length > 2)
        moduleName += `-${parts.slice(1, parts.length - 1).join('-')}`;
    } else moduleName = `eslint-plugin-${parts[0]}`;
    const configName = parts[parts.length - 1];
    config = require(moduleName).configs[configName];
  }

  schema[extensionName] = config;

})

const normalized = JSON.stringify(schema, null, 2);

const script = `
// autogenerated by bin/eslint-extensions.ts
eslintExtensions = ${normalized}
`;

fs.writeFileSync('./src/assets/eslint-extensions.js', script);
